global_defs {
    router_id shard1 # naming this node
}

vrrp_script check_alive {
    # script "/etc/keepalived/check_service.sh" # success when script returns 0; otherwise failed
    script "sleep 0" # success when script returns 0; otherwise failed
    interval 1 # call script interval 1 second
    weight -20
    fall 3 # if failed for 3 times, set priority += weight, which means 100-20=80 here
}

vrrp_instance VI_1 {
    state MASTER
    interface eth0 # binding virtual IP to
    virtual_router_id 50 # must be identical to backup
    mcast_src_ip 10.0.0.201 # IP of this node
    priority 100 # master 100-20=80 must be less than backup priority 90
    advert_int 1 # advert interval 1 second

    track_script {
        check_alive
    }

    virtual_ipaddress {
        10.0.0.200/24 # virtual IP
    }
}
